/*! yet-another-coffescript-skeleton - v0.0.2 - last build: 2013-08-24 20:37:41 */
(function(){var n,r,t,e,i,o,u,l,f,a,c,h,s,p,g,d,b,v,w,m,y,E,M;M=false;f=function(n,r){if(r==null){r=M}if(r){console.log(n)}return n};l=function(n,r){if(r==null){r=M}if(r){$("body").append(n)}return n};r=function(n){$("body").append(n);return n};c=function(n,r,t,e,i){var o;if(t==null){t=0}if(e==null){e=0}if(i==null){i=0}o=Math.PI/180;r.save();r.translate(t,e);r.rotate(i*o);r.drawImage(n,-(n.width/2),-(n.height/2));r.restore();return true};d=function(n,r,t){return 3*n+4*r+t>>>3};e=function(n,r){var t,e;t=n.color;e=r.color;return d(t[0],t[1],t[2])-d(e[0],e[1],e[2])};a=function(n,r,t,e,i,o){if(t==null){t=0}if(e==null){e=0}if(i==null){i=0}if(o==null){o=false}if(o){c(FE.mirror(r.part),n,t,e,i)}else{c(r.part,n,t,e,i)}return true};v=function(n,r,t){var i,o;i=r.length;o=r.sort(e);return function(r,e,u,l,f,c){var h,s,p;if(l==null){l=0}if(f==null){f=false}h=d(r[0],r[1],r[2]);s=Math.floor(h/256*i);p=o[s];a(n,p,e*t,u*t,l,f);return[r,e,u,c]}};p=function(n){var r,t,e,i;i=n.width;t=n.height;e=[];r=function(n,r,t,o,u){var l;l=Math.floor(u/4);return e.push({y:Math.floor(l/i),x:Math.floor(l%i),color:[n,r,t,1],rotation:_.random(0,360),mirror:_.random(0,1)===0?false:true,pixel_nr:l})};FE.rgba(n,r,function(n){return null});return e};u=function(n,r){var t,e,i;if(r==null){r=100}if(n.width>=n.height){i=r;e=n.height*i/n.width}else{e=r;i=n.width*e/n.height}i=Math.floor(i);e=Math.floor(e);t=FE.pixelyResize(n,i,e);l(t);return[t,i,e]};o=function(n,r){var t,e,i,o,u,l;t=1-r;i=0;o=function(n){return i=i+n.part.width+n.part.height};for(u=0,l=n.length;u<l;u++){e=n[u];o(e)}i=Math.floor(i/(n.length*2)*t);return i};w=function(){return null};h=function(n,r,t,e,i,l){var a,c,h,s,g,d,b,m,y,$,E,M,F,k,x,z;if(t==null){t=.3}if(e==null){e=w}if(i==null){i=w}if(l==null){l=w}if(t>=1){t=.65}if(t<.2){t=.2}x=u(n,100),y=x[0],M=x[1],$=x[2];m=o(r,t);f("pixel_w_h: "+m);z=f(FE.newCanvasToolbox(M*m,$*m)),d=z[0],b=z[1];a=v(b,r,m);F=_.shuffle(p(y));E=F.length;h=10;e(d);s=0;g=0;k=Math.ceil(F.length/h);return(c=function(){var n,r,t;if(s>=E){return l(d)}else{r=function(n){var r;r=F[s+n];if(r){return a(r.color,r.x,r.y,r.rotation,r.mirror,s)}};for(n=t=0;0<=h?t<=h:t>=h;n=0<=h?++t:--t){r(n)}i(d,g,k);s=s+h;g=g+1;return requestAnimationFrame(c)}})()};i=function(n,r){var t,e;e=[];t=function(t,i){var o,u,f,a,c;if(i&&i.length===3){c=i[0],f=i[1],o=i[2];e.push({part:t,color:[c,f,o,1]})}else{a=FE.pixelyResize(t,1,1);u=function(n,r,i,o,u){return e.push({part:t,color:[n,r,i,1]})};FE.rgba(a,u,function(n){return null})}if(e.length===$(n).size()){_.each(e,function(n){l($('<div><span style="background-color:rgba('+n.color[0]+","+n.color[1]+","+n.color[2]+","+n.color[3]+')">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div>'));return l($(n.part))});return r(e)}};$(n).each(function(n){var r,e;r=false;e=$(this).attr("data-rgb");if(e){r=_.map(e.split(","),function(n){return parseInt(n)})}return FE.byImage(this,function(n){return t(n,r)})});return true};filepicker.setKey("ApeMsWqEOSBuCzqARVfHLz");s=[];n=.55;t=function(n){return $("body").append(n)};y=function(n){return null};g=function(n){return null};b=function(r,e){var i;i=new Image;i.addEventListener("load",function(){var r,e,o,u,l,f,a;e=$(window).width()*.8;r=$(window).height()*.8;if(i.width>=e||i.height>=r){if(i.width>=i.height){f=e;l=i.height*f/i.width;if(i.height>r){o=r;u=f*o/l;l=o;f=u}}else{l=r;f=i.width*l/i.height;if(i.width>e){u=e;o=l*u/f;l=o;f=u}}i.width=f;i.height=l}$("#to_veganize").html(i);a=function(){return FE.byImage(i,function(r){return h(r,s,n,t,y,g)})};return $("#start_veganize").on("click",a)},false);return i.src="data:"+r.mimetype+";base64,"+e};m=function(){return filepicker.pick({mimetype:"image/*"},function(n){console.log(n);console.log(n.url);return filepicker.read(n,{base64encode:true},function(r){return b(n,r)},function(n){return console.log(n)})})};E=function(n){return console.log(n)};i(".parts",function(n){s=n;return $("#choose_image").on("click",m)})}).call(this);