/*! yet-another-coffescript-skeleton - v0.0.2 - last build: 2013-08-17 18:51:14 */
(function(){var n,r,t,u,e,i,o,l,f,a,c,s,h,p,g,b,v,d,m,w,F;F=true;r=5;n=15;f=function(n){if(F){console.log(n)}return n};l=function(n){if(F){$("body").append(n)}return n};c=function(n,r,t,u,e){var i;if(t==null){t=0}if(u==null){u=0}if(e==null){e=0}i=Math.PI/180;r.save();r.translate(t,u);r.rotate(e*i);r.drawImage(n,-(n.width/2),-(n.height/2));r.restore();return true};v=function(n,r,t){return 3*n+4*r+t>>>3};u=function(n,r){var t,u,e;t=n.color;u=r.color;e=(3*t[0]+4*t[1]+t[2]>>>3)-(3*u[0]+4*u[1]+u[2]>>>3);return e};a=function(n,r,t,u,e,i){if(t==null){t=0}if(u==null){u=0}if(e==null){e=0}if(i==null){i=false}if(i){c(FE.mirror(r.part),n,t,u,e)}else{c(r.part,n,t,u,e)}return true};d=function(n,r,t){var e,i;e=r.length;i=r.sort(u);return function(r,u,o,l,f,c){var s,h,p;if(l==null){l=0}if(f==null){f=false}s=v(r[0],r[1],r[2]);h=Math.floor(s/256*e);p=i[h];a(n,p,u*t,o*t,l,f);return[r,u,o,c]}};e=function(n,r){var t,u;u=[];t=function(t,e){var i,o,f,a,c;if(e&&e.length===3){c=e[0],f=e[1],i=e[2];u.push({part:t,color:[c,f,i,1]})}else{a=FE.pixelyResize(t,1,1);o=function(n,r,e,i,o){return u.push({part:t,color:[n,r,e,1]})};FE.rgba(a,o,function(n){return null})}if(u.length===$(n).size()){_.each(u,function(n){l($('<div><span style="background-color:rgba('+n.color[0]+","+n.color[1]+","+n.color[2]+","+n.color[3]+')">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div>'));return l($(n.part))});return r(u)}};return $(n).each(function(n){var r,u;r=false;u=$(this).attr("data-rgb");if(u){r=_.map(u.split(","),function(n){return parseInt(n)})}return FE.byImage(this,function(n){return t(n,r)})})};g=function(n){var r,t,u,e;e=n.width;t=n.height;u=[];r=function(n,r,t,i,o){var l;l=Math.floor(o/4);return u.push({y:Math.floor(l/e),x:Math.floor(l%e),color:[n,r,t,1],rotation:_.random(0,360),mirror:_.random(0,1)===0?false:true,pixel_nr:l})};FE.rgba(n,r,function(n){return null});return u};o=function(n,r){var t,u,e;if(r==null){r=100}if(n.width>=n.height){e=r;u=n.heigth*e/n.width}else{u=r;e=n.width*u/n.height}t=FE.pixelyResize(n,e,u);l(t);return[t,e,u]};i=function(n,r){var t,u,e,i,o,l;t=1-r;e=0;i=function(n){return e=e+n.part.width+n.part.height};for(o=0,l=n.length;o<l;o++){u=n[o];i(u)}e=Math.floor(e/(n.length*2)*t);return e};s=function(n){return null};p=function(n,r,t){return null};h=function(n){return null};w=function(n,r,t,u,e,l){var a,c,b,v,m,w,F,y,E,M,$,x,I,z,R,k,q,A,C,P,T;if(t==null){t=.3}if(u==null){u=s}if(e==null){e=p}if(l==null){l=h}if(t>=1){t=.3}c=n.width;a=n.height;P=o(n,100),I=P[0],q=P[1],z=P[2];x=i(r,t);f(x);T=f(FE.newCanvasToolbox(q*x,z*x)),y=T[0],E=T[1],M=T[2],$=T[3];b=d(E,r,x);R=g(I);A=_.shuffle(R);k=A.length;m=10;u(y);w=0;F=0;C=Math.ceil(A.length/m);return(v=function(){var n,r,t;if(w>=k){return l(y)}else{r=function(n){var r;r=A[w+n];if(r){return b(r.color,r.x,r.y,r.rotation,r.mirror,w)}};for(n=t=0;0<=m?t<=m:t>=m;n=0<=m?++t:--t){r(n)}e(y,F,C);w=w+m;F=F+1;return requestAnimationFrame(v)}})()};t=function(n){return l(n)};m=function(n){return l(n)};b=function(n){return l(n)};e(".parts",function(n){return FE.byImage($("#testimage").get(0),function(r){return w(r,n,.65,t,m,b)})})}).call(this);