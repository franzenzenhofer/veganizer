/*! yet-another-coffescript-skeleton - v0.0.2 - last build: 2013-07-23 11:08:05 */
(function(){var r,n,t,e,o,i,u,a,l,f,s,c;c=true;f=$("#testimage").get(0);o=function(r){if(c){console.log(r)}return r};e=function(r){if(c){return $("body").append(r)}};n=5;r=15;i=function(r,n,t,e,o){var i;i=Math.PI/180;n.save();n.translate(t,e);n.rotate(o*i);n.drawImage(r,-(r.width/2),-(r.height/2));return n.restore()};l=function(n,t){return function(e,o,u,a,l,f){var s,c;if(a==null){a=0}if(l==null){l=false}s=function(r,n){var t,e,o;t=pusher.color("rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")");e=pusher.color("rgba("+r[0]+","+r[1]+","+r[2]+","+r[3]+")");o=t.hue()-e.hue();if(o<0){return o*-1}else{return o}};c=_.first(_.sortBy(t,function(r){return s(r.color,e)}));if(l){i(FE.mirror(c.part),n,o*r,u*r,a)}else{i(c.part,n,o*r,u*r,a)}return[e,o,u,f]}};t=function(r){var n,t;t=[];n=function(n,i){var u,a,l,f,s;if(i&&i.length===3){s=i[0],l=i[1],u=i[2];t.push({part:n,color:[s,l,u,1]})}else{f=FE.pixelyResize(n,1,1);a=function(r,e,i,u,a){o(r+" "+e+" "+i);return t.push({part:n,color:[r,e,i,1]})};FE.rgba(f,a,function(r){return null})}if(t.length===$(".parts").size()){_.each(t,function(r){e($('<div><span style="background-color:rgba('+r.color[0]+","+r.color[1]+","+r.color[2]+","+r.color[3]+')">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div>'));return e($(r.part))});o(t);return r(t)}};return $(".parts").each(function(r){var t,e;t=false;e=$(this).attr("data-rgb");if(e){t=_.map(e.split(","),function(r){return parseInt(r)})}return FE.byImage(this,function(r){return n(r,t)})})};a=function(r,n){return $("#out").html(r)};u=function(r,n){e(r);return e(n)};s=function(t,o,i,f,s,c){var h,p,b,g,v,d,m,F,E,y,$,x,w,z,M;if(i==null){i=t.width}if(f==null){f=t.height}if(s==null){s=a}if(c==null){c=u}w=Math.floor(t.width/n);$=Math.floor(t.height/n);y=FE.pixelyResize(FE.invert(t,0),w,$);e(y);e(FE.pixelyResize(y,t.width,t.height));x=[];g=function(r,n,t,e,o){var i;i=Math.floor(o/4);return x.push({y:Math.floor(i/w),x:Math.floor(i%w),color:[r,n,t,1],rotation:_.random(0,360),mirror:_.random(0,1)===0?false:true,pixel_nr:i})};FE.rgba(y,g,function(r){return null});M=FE.newCanvasToolbox(w*r,$*r),d=M[0],m=M[1],F=M[2],E=M[3];h=l(m,o);z=_.shuffle(x);v=0;b=false;return(p=function(){var r,n,t,e;if(v>=z.length){r=FE.hardResize(d,i,f);return c(r,d)}else{t=function(r){var n,t;t=v+r;n=z[t];if(n){h(n.color,n.x,n.y,n.rotation,n.mirror,v);return s(FE.hardResize(d,i,f),d)}};for(n=e=0;e<=10;n=++e){t(n)}v=v+10;return requestAnimationFrame(p)}})()};t(function(r){return FE.byImage(f,function(n){return s(n,r)})})}).call(this);